---
title: "我的美食观"
image: http://ww3.sinaimg.cn/large/005yyi5Jjw1eoerczxex0j30im08ltau.jpg
categories: R
date: 2017-03-04
---


> 为什么我不去卖光碟的店挑电影呢?
> 因为里面没有评分啊


作为一个吃货, 挑选餐厅总是一个艰难而痛苦的决定. 幸好, 现代很多网站提供了各种餐厅的评价分数, 以一个量化的指标来评价餐厅的好坏.

但是, 没有一个网站是以口味来评价餐厅的, 而是以点评来评价, 换句话说, 口味, 环境, 服务, 缺一不可.

而且, 不得不承认, 餐厅背后的商业价值才是默认排序最需要考虑的.

对于只在意口味不在意环境和服务的我来说, 经常使用的是口味从高到低来排序, 但这个排序会很自然带来一个问题, 餐厅消费越高, 环境越好, 口味就越棒.

> 人们总希望在花了一大笔钱之后不承认自己被坑了...

所以呢, 我后来开始关注餐厅的分差, 口味环境分差越大, 说明这家店是一个超越了餐厅本身环境的美食.

支持这一论点需要一些数据比如:
```r
head(data)
```
```r
                          name city avg_price product_rating environment_rating
1    黑柴日本料理铁板烧(黑柴Ⅰ) 上海       168            8.6                8.5
2         王品牛排(上海松江店) 上海       371            9.1                9.2
3       赞巴拉藏餐(松江万达店) 上海        77            8.8                9.1
4   松荣之风和里烧肉(江学路店) 上海       144            7.9                8.2
5             吃好丸好(外冈店) 上海        12            7.1                7.1
6 陌生人火锅餐厅(开元地中海店) 上海        99            9.0                9.1
```
~~你问了数据怎么来的我也不会说的~~

最简单的方法是做个回归, 用残差看下各个餐厅是溢价还是折价
```r
model = lm(product_rating~environment_rating+avg_price+0,data=data)
summary(model)
```
```r
...
Coefficients:
                     Estimate Std. Error  t value Pr(>|t|)    
environment_rating  1.002e+00  2.889e-05 34673.77   <2e-16 ***
avg_price          -1.524e-05  5.622e-07   -27.11   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
...
```

我还以为有个新参数出来呢, 结果就是1.0, R-square 0.99.

因为某些原因(看官自己脑补), avg_price平均价格不显著, 所以, 不用考虑价格, 直接用口味减环境来评价餐厅就好.



```r
library(dplyr)
data %>%
  mutate(rate = product_rating-environment_rating) %>%   arrange(-rate) %>%
  filter(city=='上海') %>%
  head(10)
```

```{r}
                       name city avg_price product_rating environment_rating rate
1  八村烧烤海鲜满天红小龙虾 上海        42            7.5                4.2  3.3
2                    馄饨店 上海        10            4.0                1.0  3.0
3                    大肠面 上海        27            7.8                5.0  2.8
4              旧款宁波饭店 上海       120            8.2                5.5  2.7
5                华华川菜馆 上海        50            7.2                4.6  2.6
6                康林农家乐 上海        77            8.7                6.2  2.5
7            D&D Steakhouse 上海       288            8.8                6.4  2.4
8      老四海鲜城(通北路店) 上海        51            6.3                3.9  2.4
9  彩虹寿司(东体育会路总店) 上海        43            8.2                5.8  2.4
10       芷月楼老法师高汤面 上海        33            6.9                4.6  2.3
```

这批店有点恐怖, 我还是定下环境上6.5以上的店吧..我对美食的心还不够诚...

```{r}
data %>%
  mutate(rate = product_rating-environment_rating) %>%   arrange(-rate) %>%
  filter(city=='上海' & environment_rating>6.5) %>%
  head(20)
```
```r
                              name city avg_price product_rating environment_rating rate
1                       佳味海鲜馆 上海       142            9.0                6.8  2.2
2                         凯恩酒家 上海       100            9.1                6.9  2.2
3             粤汕一牛(徐虹中路店) 上海        96            9.0                7.0  2.0
4                           潮汕庄 上海       163            8.6                6.6  2.0
5                 北士大酒店中餐厅 上海       138            8.9                6.9  2.0
6                       谷沙屋面铺 上海        18            8.7                6.7  2.0
7                 蓝帝老上海本帮菜 上海        98            8.5                6.6  1.9
8             上海为民商行清真饭店 上海        23            8.5                6.6  1.9
9                       大块头排档 上海        78            8.5                6.6  1.9
10                顽固亲父串烧酒馆 上海       155            8.8                6.9  1.9
11 钱家?乔老爷铜炉涮锅(内江路总店) 上海        87            9.1                7.2  1.9
12                          蛇王王 上海       164            8.8                7.0  1.8
13                        金芬食府 上海        71            8.8                7.0  1.8
14                      广东生滚粥 上海        21            8.4                6.6  1.8
15              天全鱼庄(零陵路店) 上海        52            8.4                6.6  1.8
16            新苑私房菜(嘉善路店) 上海       128            8.6                6.8  1.8
17                湘粹(南京西路店) 上海        65            8.6                6.8  1.8
18                  兄弟情海鲜烧烤 上海        86            9.1                7.3  1.8
19                      小灯泡烧烤 上海        38            9.0                7.2  1.8
20                  阿新海鲜加工坊 上海       116            9.0                7.2  1.8
```

哦呀, 不错可以的, 试想一下, 其实每天大家吃的店一般是口味8点几的, 一家店能口味上9但是环境只有6分, 那么, 该是有多好吃....

恩, 可以约起来美食探险了, 前提是要把潮汕牛肉去掉 ~~什么米其林, 美食林,点评米其林的白白~~
